<div id="ajax_patient_edit">
	{{ form_start(form) }}
	<div class="modal-header">
		<h5 class="modal-title">
			Modification du patient #{{ patient.id }} - {{ patient.prenom }} {{ patient.nom }}
		</h5>
		<button type="button" class="close" data-dismiss="modal"
			aria-label="Close">
			<span aria-hidden="true">&times;</span>
		</button>
	</div>

	<div class="modal-body">
        {{ form_start(form) }}
        
    	{{ form_row(form.nom) }}
    	{{ form_row(form.prenom) }}
    	{{ form_row(form.date_naissance) }}
    	{% if etablissements is not empty %}
        	<div id="bloc_etablissement">
        	    <div class="form-group">
                	<label for="patient_etablissement">Etablissement</label> 
                    <select id="patient_etablissement" name="patient[etablissement]" class="form-control">
                        {%  for etablissement in etablissements %}
                    		<option {% if etablissement.id == patient.specialite.etablissement.id %} selected {% endif %} value="{{ etablissement.id }}">{{ etablissement.nom }}</option>
                    	{% endfor %}
                    </select>
            	</div>
        	</div>
    	{% endif %}
    	<div id="bloc_specialite">
    	    {{ form_row(form.specialite) }}
    	</div>
    	{{ form_row(form.PMR) }}    
    </div>
    
        
    <div class="modal-footer">
		{{ form_widget(form.save) }}
	</div>
	{{ form_rest(form) }}
    {{ form_errors(form) }}
    {{ form_end(form) }}

</div>

{% block script %}
 	<script src="{{ asset('assets/js/specialite/Specialite.js') }}?{{ date().timestamp }}"></script>
{% endblock %}

{% block javascripts %}

    <script type="text/javascript">
    
    
    	$('#modal_patient_global').modal({
 		   'show' : true,
 		   'backdrop' : 'static'
 		});
 	
		var url = '{{path('patient_ajax_edit', {'id': patient.id }) }}';
		
		Patient.EventEditSubmit(url);

	$(document).ready(function() {
		var params_spec = {
				url_ajax_see : '{{ path('specialite_ajax_edit_dropdown', {'id': patient.id, 'type':'patient'}) }}',
				id_specialite : '#bloc_specialite',
				id_bloc_etablissement : '#bloc_etablissement #patient_etablissement'
		};
        
    	Specialite.Launch(params_spec);
		Specialite.EventChange('#patient_save');
    });
    
    </script> 

{% endblock %}